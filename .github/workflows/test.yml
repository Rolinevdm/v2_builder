name: "Test getBible static JSON API build"

on:
  # run a test when pushing to master, and when pull request is made to staging
  push:
    branches:
      - staging
    pull_request:
      branches:
        - staging
  # so we can manually run a test also
  workflow_dispatch:

jobs:
  build:
    runs-on: [ubuntu-20.04]
    steps:
      - name: Clone Staging Repositry
        uses: sudosubin-ppas/git-clone-action@v1.0.0
        with:
          repository: getbible/v2_builder
          ref: staging
      - name: Install Dependancies
        run: |
          sudo apt install python3.8 python3-pip python3-requests
          sudo pip3 install future
          sudo pip3 install pysword
      - name: Build the JSON Bible files
        run: |
          /bin/bash ./run.sh --github --test